# Hybrid Music Recommendation System

This project is a hybrid music recommendation system that combines Content-Based Filtering (CBF) and Collaborative Filtering (CF).

## ğŸš€ Key Features

- **Emotion-Based Recommendations**: Generates recommendations based on musical emotion labels such as 'Happy', 'Sad', 'Calm', etc.
- **Hybrid Model**: Utilizes CBF to generate initial recommendations based on a user's listening history and then refines these results using CF to provide a final recommendation list.
- **2-Step Execution**: Enhances efficiency by separating the process into a model training/caching step (`build`) and a recommendation step (`recommend`).

---

## ğŸ“‚ Project Structure

```
/music_recommender_final/
â”œâ”€â”€ main.py                 # Main execution script (supports build and recommend modes)
â”œâ”€â”€ requirements.txt        # Python library dependencies file
â”‚
â”œâ”€â”€ orig_data/              # Directory for raw data from Kaggle
â”‚
â”œâ”€â”€ preprocessing/          # Scripts for data preprocessing
â”‚   â”œâ”€â”€ add_metadata_with_api.py # Adds track_name, artist using Spotify API
â”‚   â”œâ”€â”€ generate6labels.py  # Generates emotion labels for music
â”‚   â””â”€â”€ train.py            # (Description of what this script does)
â”‚
â”œâ”€â”€ cbf/                    # Content-Based Filtering (CBF) Module
â”‚   â”œâ”€â”€ run_cbf.py          # CBF pipeline execution script
â”‚   â”œâ”€â”€ config.py           # CBF settings (paths, model parameters, etc.)
â”‚   â”œâ”€â”€ data.py             # Data loading and preprocessing
â”‚   â”œâ”€â”€ model.py            # Autoencoder model definition
â”‚   â””â”€â”€ utils.py            # Utility functions
â”‚
â”œâ”€â”€ cf/                     # Collaborative Filtering (CF) & Hybrid Logic Module
â”‚   â””â”€â”€ run_cf.py           # CF and hybrid recommendation execution script
â”‚
â”œâ”€â”€ data/                   # Directory for preprocessed, analysis-ready data
â”‚   â””â”€â”€ dataset.zip         # Zip file containing the final dataset
â”‚
â””â”€â”€ output/                 # Directory for all generated results
    â”œâ”€â”€ cbf_intermediate/     # Cache for initial recommendations generated by CBF
    â””â”€â”€ final_recommendations/ # Final recommendation results
```

---

## ğŸ› ï¸ Installation

1.  **Clone the Project**
    ```bash
    # git clone https://github.com/your-username/your-repo-name.git
    cd music_recommender_final
    ```

2.  **Prepare the Data**
    - Download the dataset from Kaggle (You will provide the URL) and place the raw files into the `orig_data/` directory.
        - train_dataset: https://www.kaggle.com/datasets/abdullahorzan/moodify-dataset (save to 'orig_data/train_set.csv')
        - test_dataset: https://www.kaggle.com/datasets/maharshipandya/-spotify-tracks-dataset/data (save to 'orig_data/test_set.csv)
        - user_dataset: https://www.kaggle.com/datasets/andrewmvd/spotify-playlists (save to 'data/user_dataset.csv')
    - Run the scripts in the `preprocessing/` folder in sequence to process the raw data. This will generate the final dataset used by the recommendation models.
    - After preprocessing, place the final dataset files (e.g., `train_labeled_dataset.csv`, `user_dataset_filtered.csv`) into the `data/` directory.

3.  **Install Dependencies**
    All required libraries are listed in `requirements.txt`.
    ```bash
    pip install -r requirements.txt
    ```

---

## â–¶ï¸ How to Use

This project runs in two modes: **`build`** and **`recommend`**.

### Step 1: Build Model & Cache (`build` mode)

Before generating recommendations, you need to train the CBF model and pre-calculate initial recommendations to create a cache. This process should be run once initially or whenever the training data changes.

```bash
python main.py --mode build
```
This creates a CBF recommendation file in the `output/cbf_intermediate/` directory.

### Step 2: Get Recommendations for a Specific User (`recommend` mode)

After the `build` step, you can quickly get personalized recommendations for a specific user by providing their ID and an emotion label.

-   `--user`: The ID of the user to receive recommendations.
-   `--emotion`: The emotion label (e.g., `Happy`, `Sad`, `Angry`, `Calm`, `Romantic`, `Energetic`).
-   `--top_k`: The number of tracks to recommend (default: 30).

**Example:**
To get the top 20 recommendations for user `1` based on the `Happy` emotion:

```bash
python main.py --mode recommend --user 1 --emotion Happy --top_k 20
```

**Output:**
The recommendation result will be saved as a `.csv` file in the `output/final_recommendations/` directory, with a name like `cf_rec_user_1_Happy_... .csv`.
